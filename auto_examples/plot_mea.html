

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Model Error Analysis on Boston house &mdash; mea 0.1-git documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_override.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> mea
          

          
            
            <img src="../_static/mea.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
      <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Versions</span>
        v: stable
        <span class="fa fa-caret-down"></span>
      </span>
      <div class="rst-other-versions">
        <dl>
          <dt>Versions</dt>
          
            <dd><a href="https://sphinx-gallery.github.io/dev">dev</a></dd>
          
            <dd><a href="https://sphinx-gallery.github.io/stable">stable</a></dd>
          
        </dl>
      </div>
    </div>

    
            
            
              
            
            
              <p class="caption"><span class="caption-text">Model Error Analysis</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction to Model Error Analysis</a></li>
</ul>

            
          

  
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">mea</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li>Model Error Analysis on Boston house</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-plot-mea-py"><span class="std std-ref">here</span></a> to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="model-error-analysis-on-boston-house">
<span id="sphx-glr-auto-examples-plot-mea-py"></span><h1>Model Error Analysis on Boston house<a class="headerlink" href="#model-error-analysis-on-boston-house" title="Permalink to this headline">¶</a></h1>
<p>Here we train a primary model to predict the price of houses in Boston.
Then we build a Model Performance Predictor, a Decision Tree trained to
predict on what samples the primary model will yield Wrong or Correct
predictions. We then use the Model Performance Predictor to understand
what are the problematic samples and features where the majority of
model failures occurs.</p>
<p>Those are the necessary imports and initializations</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.load_boston.html#sklearn.datasets.load_boston" title="View documentation for sklearn.datasets.load_boston"><span class="n">load_boston</span></a>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html#sklearn.model_selection.train_test_split" title="View documentation for sklearn.model_selection.train_test_split"><span class="n">train_test_split</span></a>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html#sklearn.ensemble.RandomForestRegressor" title="View documentation for sklearn.ensemble.RandomForestRegressor"><span class="n">RandomForestRegressor</span></a>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">mea.error_analyzer</span> <span class="kn">import</span> <span class="n">ErrorAnalyzer</span>
<span class="kn">from</span> <span class="nn">mea.error_visualizer</span> <span class="kn">import</span> <span class="n">ErrorVisualizer</span>

<a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.seed.html#numpy.random.seed" title="View documentation for numpy.random.seed"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span></a><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
<p>Load the Boston houses dataset</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="https://scikit-learn.org/stable/modules/generated/sklearn.utils.Bunch.html#sklearn.utils.Bunch" title="View documentation for sklearn.utils.Bunch"><span class="n">dataset</span></a> <span class="o">=</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.load_boston.html#sklearn.datasets.load_boston" title="View documentation for sklearn.datasets.load_boston"><span class="n">load_boston</span></a><span class="p">()</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="View documentation for numpy.ndarray"><span class="n">X</span></a> <span class="o">=</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.utils.Bunch.html#sklearn.utils.Bunch" title="View documentation for sklearn.utils.Bunch"><span class="n">dataset</span></a><span class="o">.</span><span class="n">data</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="View documentation for numpy.ndarray"><span class="n">y</span></a> <span class="o">=</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.utils.Bunch.html#sklearn.utils.Bunch" title="View documentation for sklearn.utils.Bunch"><span class="n">dataset</span></a><span class="o">.</span><span class="n">target</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="View documentation for numpy.ndarray"><span class="n">feature_names</span></a> <span class="o">=</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.utils.Bunch.html#sklearn.utils.Bunch" title="View documentation for sklearn.utils.Bunch"><span class="n">dataset</span></a><span class="o">.</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="View documentation for numpy.ndarray"><span class="n">feature_names</span></a>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="View documentation for numpy.ndarray"><span class="n">X_train</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="View documentation for numpy.ndarray"><span class="n">X_test</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="View documentation for numpy.ndarray"><span class="n">y_train</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="View documentation for numpy.ndarray"><span class="n">y_test</span></a> <span class="o">=</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html#sklearn.model_selection.train_test_split" title="View documentation for sklearn.model_selection.train_test_split"><span class="n">train_test_split</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="View documentation for numpy.ndarray"><span class="n">X</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="View documentation for numpy.ndarray"><span class="n">y</span></a><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Train a RandomForestRegressor to predict the price.
This is the primary model.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><a href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html#sklearn.ensemble.RandomForestRegressor" title="View documentation for sklearn.ensemble.RandomForestRegressor"><span class="n">model</span></a> <span class="o">=</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html#sklearn.ensemble.RandomForestRegressor" title="View documentation for sklearn.ensemble.RandomForestRegressor"><span class="n">RandomForestRegressor</span></a><span class="p">()</span>
<a href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html#sklearn.ensemble.RandomForestRegressor.fit" title="View documentation for sklearn.ensemble.RandomForestRegressor.fit"><span class="n">model</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="View documentation for numpy.ndarray"><span class="n">X_train</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="View documentation for numpy.ndarray"><span class="n">y_train</span></a><span class="p">)</span>

<span class="n">r2_score</span> <span class="o">=</span> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html#sklearn.ensemble.RandomForestRegressor.score" title="View documentation for sklearn.ensemble.RandomForestRegressor.score"><span class="n">model</span><span class="o">.</span><span class="n">score</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="View documentation for numpy.ndarray"><span class="n">X_test</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="View documentation for numpy.ndarray"><span class="n">y_test</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;R^2: </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r2_score</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>R^2: 0.91
</pre></div>
</div>
<p>Fit a Model Performance Predictor on the primary model performances</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">error_analyzer</span> <span class="o">=</span> <span class="n">ErrorAnalyzer</span><span class="p">(</span><a href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html#sklearn.ensemble.RandomForestRegressor" title="View documentation for sklearn.ensemble.RandomForestRegressor"><span class="n">model</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="View documentation for numpy.ndarray"><span class="n">feature_names</span></a><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="View documentation for numpy.ndarray"><span class="n">feature_names</span></a><span class="p">)</span>
<span class="n">error_analyzer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="View documentation for numpy.ndarray"><span class="n">X_test</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="View documentation for numpy.ndarray"><span class="n">y_test</span></a><span class="p">)</span>
</pre></div>
</div>
<p>Print metrics regarding the Model Performance Predictor</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">error_analyzer</span><span class="o">.</span><span class="n">mpp_summary</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="View documentation for numpy.ndarray"><span class="n">X_test</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="View documentation for numpy.ndarray"><span class="n">y_test</span></a><span class="p">,</span> <span class="n">output_dict</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>The MPP was trained with accuracy 81.89%.
The Decision Tree estimated the primary models accuracy to 78.74%.
The true accuracy of the primary model is 62.20.%
The Fidelity of the MPP is 83.46%.
Warning: the built MPP might not be representative of the primary model performances.
The MPP predicted model accuracy is considered too different from the true model accuracy.
</pre></div>
</div>
<p>Plot the Model Performance Predictor Decision Tree</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">error_visualizer</span> <span class="o">=</span> <span class="n">ErrorVisualizer</span><span class="p">(</span><span class="n">error_analyzer</span><span class="p">)</span>
<span class="n">error_visualizer</span><span class="o">.</span><span class="n">plot_error_tree</span><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;graphviz.files.Source object at 0x12b1c4588&gt;
</pre></div>
</div>
<p>Print the details regarding the decision tree nodes containing the majority of errors</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">error_analyzer</span><span class="o">.</span><span class="n">error_node_summary</span><span class="p">(</span><span class="n">leaf_selector</span><span class="o">=</span><span class="s2">&quot;all_errors&quot;</span><span class="p">,</span> <span class="n">add_path_to_leaves</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">print_summary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>LEAF 4:
     Correct predictions: 0 | Wrong predictions: 9 | Local error (purity): 1.00 | Global error: 0.19
     Path to leaf:
     TAX &lt;= 267.00
        B &gt; 383.96
           PTRATIO &lt;= 18.10
LEAF 9:
     Correct predictions: 0 | Wrong predictions: 3 | Local error (purity): 1.00 | Global error: 0.06
     Path to leaf:
     TAX &lt;= 267.00
        B &gt; 383.96
           PTRATIO &gt; 18.10
              DIS &gt; 5.73
LEAF 15:
     Correct predictions: 0 | Wrong predictions: 3 | Local error (purity): 1.00 | Global error: 0.06
     Path to leaf:
     TAX &gt; 267.00
        B &lt;= 385.84
           NOX &lt;= 0.70
              LSTAT &lt;= 26.97
                 DIS &gt; 7.57
LEAF 16:
     Correct predictions: 0 | Wrong predictions: 3 | Local error (purity): 1.00 | Global error: 0.06
     Path to leaf:
     TAX &gt; 267.00
        B &lt;= 385.84
           NOX &lt;= 0.70
              LSTAT &gt; 26.97
LEAF 19:
     Correct predictions: 0 | Wrong predictions: 2 | Local error (purity): 1.00 | Global error: 0.04
     Path to leaf:
     TAX &gt; 267.00
        B &lt;= 385.84
           NOX &gt; 0.70
              LSTAT &lt;= 14.09
                 DIS &lt;= 1.93
LEAF 8:
     Correct predictions: 0 | Wrong predictions: 1 | Local error (purity): 1.00 | Global error: 0.02
     Path to leaf:
     TAX &lt;= 267.00
        B &gt; 383.96
           PTRATIO &gt; 18.10
              DIS &lt;= 5.73
                 CRIM &gt; 0.08
LEAF 30:
     Correct predictions: 1 | Wrong predictions: 5 | Local error (purity): 0.83 | Global error: 0.10
     Path to leaf:
     TAX &gt; 267.00
        B &gt; 385.84
           AGE &gt; 42.45
              RM &gt; 6.61
                 LSTAT &gt; 2.72

[{&#39;id&#39;: 4, &#39;n_corrects&#39;: 0.0, &#39;n_errors&#39;: 9.0, &#39;local_error&#39;: 1.0, &#39;global_error&#39;: 0.1875, &#39;path_to_leaf&#39;: deque([&#39;TAX &lt;= 267.00&#39;, &#39;B &gt; 383.96&#39;, &#39;PTRATIO &lt;= 18.10&#39;])}, {&#39;id&#39;: 9, &#39;n_corrects&#39;: 0.0, &#39;n_errors&#39;: 3.0, &#39;local_error&#39;: 1.0, &#39;global_error&#39;: 0.0625, &#39;path_to_leaf&#39;: deque([&#39;TAX &lt;= 267.00&#39;, &#39;B &gt; 383.96&#39;, &#39;PTRATIO &gt; 18.10&#39;, &#39;DIS &gt; 5.73&#39;])}, {&#39;id&#39;: 15, &#39;n_corrects&#39;: 0.0, &#39;n_errors&#39;: 3.0, &#39;local_error&#39;: 1.0, &#39;global_error&#39;: 0.0625, &#39;path_to_leaf&#39;: deque([&#39;TAX &gt; 267.00&#39;, &#39;B &lt;= 385.84&#39;, &#39;NOX &lt;= 0.70&#39;, &#39;LSTAT &lt;= 26.97&#39;, &#39;DIS &gt; 7.57&#39;])}, {&#39;id&#39;: 16, &#39;n_corrects&#39;: 0.0, &#39;n_errors&#39;: 3.0, &#39;local_error&#39;: 1.0, &#39;global_error&#39;: 0.0625, &#39;path_to_leaf&#39;: deque([&#39;TAX &gt; 267.00&#39;, &#39;B &lt;= 385.84&#39;, &#39;NOX &lt;= 0.70&#39;, &#39;LSTAT &gt; 26.97&#39;])}, {&#39;id&#39;: 19, &#39;n_corrects&#39;: 0.0, &#39;n_errors&#39;: 2.0, &#39;local_error&#39;: 1.0, &#39;global_error&#39;: 0.041666666666666664, &#39;path_to_leaf&#39;: deque([&#39;TAX &gt; 267.00&#39;, &#39;B &lt;= 385.84&#39;, &#39;NOX &gt; 0.70&#39;, &#39;LSTAT &lt;= 14.09&#39;, &#39;DIS &lt;= 1.93&#39;])}, {&#39;id&#39;: 8, &#39;n_corrects&#39;: 0.0, &#39;n_errors&#39;: 1.0, &#39;local_error&#39;: 1.0, &#39;global_error&#39;: 0.020833333333333332, &#39;path_to_leaf&#39;: deque([&#39;TAX &lt;= 267.00&#39;, &#39;B &gt; 383.96&#39;, &#39;PTRATIO &gt; 18.10&#39;, &#39;DIS &lt;= 5.73&#39;, &#39;CRIM &gt; 0.08&#39;])}, {&#39;id&#39;: 30, &#39;n_corrects&#39;: 1.0, &#39;n_errors&#39;: 5.0, &#39;local_error&#39;: 0.8333333333333334, &#39;global_error&#39;: 0.10416666666666667, &#39;path_to_leaf&#39;: deque([&#39;TAX &gt; 267.00&#39;, &#39;B &gt; 385.84&#39;, &#39;AGE &gt; 42.45&#39;, &#39;RM &gt; 6.61&#39;, &#39;LSTAT &gt; 2.72&#39;])}]
</pre></div>
</div>
<p>Plot the feature distributions of samples in the nodes containing the majority of errors
Rank features by correlation to error</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">error_visualizer</span><span class="o">.</span><span class="n">plot_feature_distributions_on_leaves</span><span class="p">(</span><span class="n">leaf_selector</span><span class="o">=</span><span class="s2">&quot;all_errors&quot;</span><span class="p">,</span> <span class="n">top_k_features</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img alt="../_images/sphx_glr_plot_mea_001.png" class="sphx-glr-multi-img" src="../_images/sphx_glr_plot_mea_001.png" />
</li>
<li><img alt="../_images/sphx_glr_plot_mea_002.png" class="sphx-glr-multi-img" src="../_images/sphx_glr_plot_mea_002.png" />
</li>
<li><img alt="../_images/sphx_glr_plot_mea_003.png" class="sphx-glr-multi-img" src="../_images/sphx_glr_plot_mea_003.png" />
</li>
<li><img alt="../_images/sphx_glr_plot_mea_004.png" class="sphx-glr-multi-img" src="../_images/sphx_glr_plot_mea_004.png" />
</li>
<li><img alt="../_images/sphx_glr_plot_mea_005.png" class="sphx-glr-multi-img" src="../_images/sphx_glr_plot_mea_005.png" />
</li>
<li><img alt="../_images/sphx_glr_plot_mea_006.png" class="sphx-glr-multi-img" src="../_images/sphx_glr_plot_mea_006.png" />
</li>
<li><img alt="../_images/sphx_glr_plot_mea_007.png" class="sphx-glr-multi-img" src="../_images/sphx_glr_plot_mea_007.png" />
</li>
<li><img alt="../_images/sphx_glr_plot_mea_008.png" class="sphx-glr-multi-img" src="../_images/sphx_glr_plot_mea_008.png" />
</li>
<li><img alt="../_images/sphx_glr_plot_mea_009.png" class="sphx-glr-multi-img" src="../_images/sphx_glr_plot_mea_009.png" />
</li>
<li><img alt="../_images/sphx_glr_plot_mea_010.png" class="sphx-glr-multi-img" src="../_images/sphx_glr_plot_mea_010.png" />
</li>
<li><img alt="../_images/sphx_glr_plot_mea_011.png" class="sphx-glr-multi-img" src="../_images/sphx_glr_plot_mea_011.png" />
</li>
<li><img alt="../_images/sphx_glr_plot_mea_012.png" class="sphx-glr-multi-img" src="../_images/sphx_glr_plot_mea_012.png" />
</li>
<li><img alt="../_images/sphx_glr_plot_mea_013.png" class="sphx-glr-multi-img" src="../_images/sphx_glr_plot_mea_013.png" />
</li>
<li><img alt="../_images/sphx_glr_plot_mea_014.png" class="sphx-glr-multi-img" src="../_images/sphx_glr_plot_mea_014.png" />
</li>
<li><img alt="../_images/sphx_glr_plot_mea_015.png" class="sphx-glr-multi-img" src="../_images/sphx_glr_plot_mea_015.png" />
</li>
<li><img alt="../_images/sphx_glr_plot_mea_016.png" class="sphx-glr-multi-img" src="../_images/sphx_glr_plot_mea_016.png" />
</li>
<li><img alt="../_images/sphx_glr_plot_mea_017.png" class="sphx-glr-multi-img" src="../_images/sphx_glr_plot_mea_017.png" />
</li>
<li><img alt="../_images/sphx_glr_plot_mea_018.png" class="sphx-glr-multi-img" src="../_images/sphx_glr_plot_mea_018.png" />
</li>
<li><img alt="../_images/sphx_glr_plot_mea_019.png" class="sphx-glr-multi-img" src="../_images/sphx_glr_plot_mea_019.png" />
</li>
<li><img alt="../_images/sphx_glr_plot_mea_020.png" class="sphx-glr-multi-img" src="../_images/sphx_glr_plot_mea_020.png" />
</li>
<li><img alt="../_images/sphx_glr_plot_mea_021.png" class="sphx-glr-multi-img" src="../_images/sphx_glr_plot_mea_021.png" />
</li>
</ul>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Leaf 4 (Wrong prediction: 1.000, Correct prediction: 0.000)
Leaf 9 (Wrong prediction: 1.000, Correct prediction: 0.000)
Leaf 15 (Wrong prediction: 1.000, Correct prediction: 0.000)
Leaf 16 (Wrong prediction: 1.000, Correct prediction: 0.000)
Leaf 19 (Wrong prediction: 1.000, Correct prediction: 0.000)
Leaf 8 (Wrong prediction: 1.000, Correct prediction: 0.000)
Leaf 30 (Wrong prediction: 0.833, Correct prediction: 0.167)
/Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/site-packages/mea-0.1-py3.6.egg/mea/error_visualizer.py:49: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  plt.figure(figsize=figsize)
</pre></div>
</div>
<div class="section" id="discussion">
<h2>Discussion<a class="headerlink" href="#discussion" title="Permalink to this headline">¶</a></h2>
<div class="section" id="model-performance-predictor-metrics">
<h3>Model Performance Predictor Metrics<a class="headerlink" href="#model-performance-predictor-metrics" title="Permalink to this headline">¶</a></h3>
<p>We are facing a regression problem, but the primary predictions are thresholded
and categorized into Wrong/Correct predictions. In this context, the primary task is
translated into a binary classification and the primary model can be scored using an
accuracy as the the average number of samples predicted as close enough to the true price.
This accuracy in this example is of 92.9%, that is correctly learnt by the MPP
estimating the very same value. The analysis will focus than on those 7.1% of test samples
where the primary predictions failed, i.e. are not close enough to the true value.</p>
</div>
<div class="section" id="model-failures">
<h3>Model Failures<a class="headerlink" href="#model-failures" title="Permalink to this headline">¶</a></h3>
<p>The majority of failures are highlighted first in the most relevant failure node, the LEAF 16.
From the feature distribution, we see that most failures occur for high values of feature RM and AGE.
In the next iteration of model design, we need a strategy to improve the primary model
on those sub-populations.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  10.720 seconds)</p>
<p><strong>Estimated memory usage:</strong>  198 MB</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-plot-mea-py">
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../_downloads/b9c7db120083279d70637f728d144247/plot_mea.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_mea.py</span></code></a></p>
</div>
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../_downloads/ec9cbd242d52ca19b807cf8af86d2c1f/plot_mea.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_mea.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020-2020, Dataiku

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-169600606-1', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>